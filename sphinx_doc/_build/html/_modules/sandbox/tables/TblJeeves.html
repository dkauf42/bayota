

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sandbox.tables.TblJeeves &mdash; OptSandbox 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="OptSandbox 0.1 documentation" href="../../../index.html"/>
        <link rel="up" title="sandbox" href="../../sandbox.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> OptSandbox
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sandbox.html">sandbox package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sandbox.gui.html">sandbox.gui package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sandbox.tables.html">sandbox.tables package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sandbox.tests.html">sandbox.tests package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sandbox.util.html">sandbox.util package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">OptSandbox</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      
          <li><a href="../../sandbox.html">sandbox</a> &raquo;</li>
      
    <li>sandbox.tables.TblJeeves</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sandbox.tables.TblJeeves</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">permutations</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">sandbox.sqltables.source_data</span> <span class="kn">import</span> <span class="n">SourceData</span>
<span class="kn">from</span> <span class="nn">sandbox.__init__</span> <span class="kn">import</span> <span class="n">get_tempdir</span>
<span class="kn">from</span> <span class="nn">sandbox.__init__</span> <span class="kn">import</span> <span class="n">get_sqlsourcetabledir</span>


<div class="viewcode-block" id="loadDataframe"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.loadDataframe">[docs]</a><span class="k">def</span> <span class="nf">loadDataframe</span><span class="p">(</span><span class="n">tblName</span><span class="p">,</span> <span class="n">loc</span><span class="p">):</span>
    <span class="n">dtype_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">tblName</span> <span class="o">==</span> <span class="s2">&quot;ImpBmpSubmittedManureTransport&quot;</span><span class="p">:</span>
        <span class="n">dtype_dict</span><span class="p">[</span><span class="s2">&quot;fipsfrom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">str</span>

    <span class="n">fileLocation</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">tblName</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fileLocation</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype_dict</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

    <span class="c1"># Added by DEKAUFMAN to read csv in chunks instead of all at once</span>
    <span class="c1">#tp = pd.read_csv(fileLocation, header=None, encoding=&quot;utf-8&quot;, chunksize=500000)</span>
    <span class="c1">#df = pd.concat(tp, ignore_index=True)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">column</span><span class="p">:</span> <span class="n">column</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">tblName</span> <span class="o">==</span> <span class="s2">&quot;TblBmpGroup&quot;</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ruleset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ruleset&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="checkOnlyOne"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.checkOnlyOne">[docs]</a><span class="k">def</span> <span class="nf">checkOnlyOne</span><span class="p">(</span><span class="n">iterable</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></div>


<div class="viewcode-block" id="TblJeeves"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves">[docs]</a><span class="k">class</span> <span class="nc">TblJeeves</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper for table queries. Provides methods for querying different information</span>

<span class="sd">        Attributes:</span>
<span class="sd">            source (SourceData): The source object contains all of the data tables</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadSourceFromSQL</span><span class="p">()</span>

<div class="viewcode-block" id="TblJeeves.loadSourceFromSQL"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.loadSourceFromSQL">[docs]</a>    <span class="k">def</span> <span class="nf">loadSourceFromSQL</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">savename</span> <span class="o">=</span> <span class="n">get_tempdir</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;SourceData.obj&#39;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">savename</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">savename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">sourcedata</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1"> object does not exist yet. Generating...&gt;&#39;</span> <span class="o">%</span> <span class="n">SourceData</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
            <span class="c1"># Source tables are loaded.</span>
            <span class="n">sourcedata</span> <span class="o">=</span> <span class="n">SourceData</span><span class="p">()</span>
            <span class="n">tbllist</span> <span class="o">=</span> <span class="n">sourcedata</span><span class="o">.</span><span class="n">getTblList</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">tblName</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">tbllist</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">tbllist</span><span class="p">)):</span>
                <span class="c1"># for tblName in tbllist:</span>
                <span class="c1"># print(&quot;loading source:&quot;, tblName)</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">loadDataframe</span><span class="p">(</span><span class="n">tblName</span><span class="p">,</span> <span class="n">get_sqlsourcetabledir</span><span class="p">())</span>
                <span class="n">sourcedata</span><span class="o">.</span><span class="n">addTable</span><span class="p">(</span><span class="n">tblName</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">savename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">sourcedata</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sourcedata</span></div>

    <span class="c1"># Geography Methods</span>
<div class="viewcode-block" id="TblJeeves.countyid_from_countystatestrs"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.countyid_from_countystatestrs">[docs]</a>    <span class="k">def</span> <span class="nf">countyid_from_countystatestrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getfrom</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">TblCounty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblCounty</span>  <span class="c1"># get relevant source data</span>

        <span class="n">areas</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">getfrom</span><span class="p">]</span>  <span class="c1"># split (&#39;County, StateAbbrev&#39;)</span>
        <span class="n">rowmask</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;countyname&#39;</span><span class="p">,</span> <span class="s1">&#39;stateabbreviation&#39;</span><span class="p">])</span>

        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;countyname&#39;</span><span class="p">,</span> <span class="s1">&#39;stateid&#39;</span><span class="p">,</span> <span class="s1">&#39;stateabbreviation&#39;</span><span class="p">,</span> <span class="s1">&#39;fips&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblCounty</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rowmask</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">]]</span>  <span class="c1"># pass column name as list so return type is pandas.DataFrame</span></div>

<div class="viewcode-block" id="TblJeeves.lrsegnames_from"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.lrsegnames_from">[docs]</a>    <span class="k">def</span> <span class="nf">lrsegnames_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lrsegids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lrsegids</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">lrsegids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lrsegids</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;landriversegment&#39;</span><span class="p">])</span>

        <span class="n">TblLandRiverSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegment</span>  <span class="c1"># get relevant source data</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;landriversegment&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLandRiverSegment</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lrsegids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;landriversegment&#39;</span><span class="p">]]</span>  <span class="c1"># pass column name as list so return type is pandas.DataFrame</span></div>

<div class="viewcode-block" id="TblJeeves.lrsegids_from"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.lrsegids_from">[docs]</a>    <span class="k">def</span> <span class="nf">lrsegids_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lrsegnames</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">countystatestrs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">countyid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">(</span><span class="n">lrsegnames</span><span class="p">,</span> <span class="n">countystatestrs</span><span class="p">,</span> <span class="n">countyid</span><span class="p">)</span>
        <span class="n">kwargsNoDataFrames</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">checkOnlyOne</span><span class="p">(</span><span class="n">kwargsNoDataFrames</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;One and only one keyword argument must be specified&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">lrsegnames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lrsegids_from_lrsegnames</span><span class="p">(</span><span class="n">getfrom</span><span class="o">=</span><span class="n">lrsegnames</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">countystatestrs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lrsegids_from_countystatestrs</span><span class="p">(</span><span class="n">getfrom</span><span class="o">=</span><span class="n">countystatestrs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">countyid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lrsegids_from_countyid</span><span class="p">(</span><span class="n">getfrom</span><span class="o">=</span><span class="n">countyid</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__lrsegids_from_lrsegnames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getfrom</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">getfrom</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">getfrom</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">getfrom</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;landriversegment&#39;</span><span class="p">])</span>

        <span class="n">TblLandRiverSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegment</span>  <span class="c1"># get relevant source data</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;landriversegment&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLandRiverSegment</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">getfrom</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">]]</span>  <span class="c1"># pass column name as list so return type is pandas.DataFrame</span>

    <span class="k">def</span> <span class="nf">__lrsegids_from_countystatestrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getfrom</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">countyids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">countyid_from_countystatestrs</span><span class="p">(</span><span class="n">getfrom</span><span class="o">=</span><span class="n">getfrom</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lrsegids_from_countyid</span><span class="p">(</span><span class="n">getfrom</span><span class="o">=</span><span class="n">countyids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__lrsegids_from_countyid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">getfrom</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">getfrom</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">getfrom</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">getfrom</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">])</span>

        <span class="n">TblLandRiverSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegment</span>  <span class="c1"># get relevant source data</span>

        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;landriversegment&#39;</span><span class="p">,</span> <span class="s1">&#39;stateid&#39;</span><span class="p">,</span> <span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;outofcbws&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLandRiverSegment</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">getfrom</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">]]</span>  <span class="c1"># pass column name as list so return type is pandas.DataFrame</span>

<div class="viewcode-block" id="TblJeeves.lrsegids_from_geoscale_with_names"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.lrsegids_from_geoscale_with_names">[docs]</a>    <span class="k">def</span> <span class="nf">lrsegids_from_geoscale_with_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">areanames</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span> <span class="s1">&#39;County&#39;</span><span class="p">:</span>
            <span class="n">tblsubset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lrsegids_from</span><span class="p">(</span><span class="n">countystatestrs</span><span class="o">=</span><span class="n">areanames</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Specified scale &quot;</span><span class="si">%s</span><span class="s1">&quot; is unrecognized&#39;</span> <span class="o">%</span> <span class="n">scale</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span></div>

<div class="viewcode-block" id="TblJeeves.countyids_from_lrsegids"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.countyids_from_lrsegids">[docs]</a>    <span class="k">def</span> <span class="nf">countyids_from_lrsegids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lrsegids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">TblLandRiverSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegment</span>  <span class="c1"># get relevant source data</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;countyid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLandRiverSegment</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lrsegids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">]]</span>  <span class="c1"># pass column name as list so return type is pandas.DataFrame</span></div>

    <span class="c1"># Agency Methods</span>
<div class="viewcode-block" id="TblJeeves.agencyids_from"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.agencyids_from">[docs]</a>    <span class="k">def</span> <span class="nf">agencyids_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agencycodes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agencycodes</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">agencycodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">agencycodes</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;agencycode&#39;</span><span class="p">])</span>

        <span class="n">TblAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAgency</span>  <span class="c1"># get relevant source data</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;agencycode&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblAgency</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">agencycodes</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;agencyid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.agencylrsegidtable_from_lrsegids"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.agencylrsegidtable_from_lrsegids">[docs]</a>    <span class="k">def</span> <span class="nf">agencylrsegidtable_from_lrsegids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lrsegids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">TblLandRiverSegmentAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegmentAgency</span>  <span class="c1"># get relevant source data</span>

        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLandRiverSegmentAgency</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lrsegids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.agencyids_from_lrsegids"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.agencyids_from_lrsegids">[docs]</a>    <span class="k">def</span> <span class="nf">agencyids_from_lrsegids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lrsegids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">TblLandRiverSegmentAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegmentAgency</span>  <span class="c1"># get relevant source data</span>

        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLandRiverSegmentAgency</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lrsegids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;agencyid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.agencies_from_lrsegnames"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.agencies_from_lrsegnames">[docs]</a>    <span class="k">def</span> <span class="nf">agencies_from_lrsegnames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lrsegnames</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lrsegnames</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">lrsegnames</span> <span class="o">=</span> <span class="n">lrsegnames</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">TblAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAgency</span>  <span class="c1"># get relevant source data</span>

        <span class="n">tblwithlrsegids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lrsegids_from</span><span class="p">(</span><span class="n">lrsegnames</span><span class="o">=</span><span class="n">lrsegnames</span><span class="p">)</span>
        <span class="n">tblwithagencyids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agencyids_from_lrsegids</span><span class="p">(</span><span class="n">lrsegids</span><span class="o">=</span><span class="n">tblwithlrsegids</span><span class="p">)</span>

        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;agencyid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencycode&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyfullname&#39;</span><span class="p">,</span> <span class="s1">&#39;agencytypeid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblAgency</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tblwithagencyids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;agencycode&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.all_agency_names"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.all_agency_names">[docs]</a>    <span class="k">def</span> <span class="nf">all_agency_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TblAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAgency</span>  <span class="c1"># get relevant source data</span>
        <span class="k">return</span> <span class="n">TblAgency</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;agencycode&#39;</span><span class="p">]</span></div>

    <span class="c1"># Sector Methods</span>
<div class="viewcode-block" id="TblJeeves.sectorids_from"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.sectorids_from">[docs]</a>    <span class="k">def</span> <span class="nf">sectorids_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sectornames</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sectornames</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">sectornames</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sectornames</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sector&#39;</span><span class="p">])</span>

        <span class="n">TblSector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblSector</span>  <span class="c1"># get relevant source data</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sector&#39;</span><span class="p">,</span> <span class="s1">&#39;sectorid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblSector</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sectornames</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;sectorid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.all_sector_names"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.all_sector_names">[docs]</a>    <span class="k">def</span> <span class="nf">all_sector_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TblSector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblSector</span>  <span class="c1"># get relevant source data</span>
        <span class="k">return</span> <span class="n">TblSector</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;sector&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="TblJeeves.all_sectorids"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.all_sectorids">[docs]</a>    <span class="k">def</span> <span class="nf">all_sectorids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TblSector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblSector</span>  <span class="c1"># get relevant source data</span>
        <span class="k">return</span> <span class="n">TblSector</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;sectorid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.all_geotypes"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.all_geotypes">[docs]</a>    <span class="k">def</span> <span class="nf">all_geotypes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TblGeoType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblGeographyType</span>  <span class="c1"># get relevant source data</span>
        <span class="n">TblGeoType</span> <span class="o">=</span> <span class="n">TblGeoType</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">TblGeoType</span><span class="p">[</span><span class="s1">&#39;castscenariogeographytype&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">True</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">TblGeoType</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;geographytypeid&#39;</span><span class="p">,</span> <span class="s1">&#39;geographytype&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.geonames_from_geotypeid"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.geonames_from_geotypeid">[docs]</a>    <span class="k">def</span> <span class="nf">geonames_from_geotypeid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geotype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">TblGeography</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblGeography</span>  <span class="c1"># get relevant source data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">geotype</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Geography Type must be specified to get area names&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geotype</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geotype</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="c1"># Assume that if string, then we have been passed a geographytypename instead of a geographytypeid</span>
                <span class="n">TblGeoType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblGeographyType</span>  <span class="c1"># get relevant source data</span>
                <span class="n">typenames</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">geotype</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;geographytype&#39;</span><span class="p">])</span>
                <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;geographytypeid&#39;</span><span class="p">,</span> <span class="s1">&#39;geographytype&#39;</span><span class="p">]</span>
                <span class="n">typeids</span> <span class="o">=</span> <span class="n">TblGeoType</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">typenames</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">typeids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">geotype</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;geographytypeid&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geotype</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">typeids</span> <span class="o">=</span> <span class="n">geotype</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Geography Type must be specified as a list of str, list of ids, or pandas.DataFrame&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">typeids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Geography Type </span><span class="si">%s</span><span class="s1"> was unrecognized&#39;</span> <span class="o">%</span> <span class="n">geotype</span><span class="p">)</span>

        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;geographyid&#39;</span><span class="p">,</span> <span class="s1">&#39;geographytypeid&#39;</span><span class="p">,</span> <span class="s1">&#39;geographyfullname&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblGeography</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">typeids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;geographyfullname&#39;</span><span class="p">]</span></div>

    <span class="c1"># Load Source Methods</span>
<div class="viewcode-block" id="TblJeeves.loadsourcegroupids_from"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.loadsourcegroupids_from">[docs]</a>    <span class="k">def</span> <span class="nf">loadsourcegroupids_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sectorids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sectorids</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">sectorids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sectorids</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sectorid&#39;</span><span class="p">])</span>

        <span class="n">TblLoadSourceGroupSector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLoadSourceGroupSector</span>  <span class="c1"># get relevant source data</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;loadsourcegroupid&#39;</span><span class="p">,</span> <span class="s1">&#39;sectorid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLoadSourceGroupSector</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sectorids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;loadsourcegroupid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.loadsourceids_from"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.loadsourceids_from">[docs]</a>    <span class="k">def</span> <span class="nf">loadsourceids_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sectorids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sectorids</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">sectorids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sectorids</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sectorid&#39;</span><span class="p">])</span>

        <span class="n">TblLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLoadSource</span>  <span class="c1"># get relevant source data</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;sectorid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLoadSource</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sectorids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;loadsourceid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.sourceLrsegAgencyIDtable_from_lrsegAgencySectorids"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.sourceLrsegAgencyIDtable_from_lrsegAgencySectorids">[docs]</a>    <span class="k">def</span> <span class="nf">sourceLrsegAgencyIDtable_from_lrsegAgencySectorids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lrsegagencyidtable</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sectorids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the load sources present (whether zero acres or not) in the specified lrseg-agency-sectors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get relevant source data</span>
        <span class="n">TblLandRiverSegmentAgencyLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegmentAgencyLoadSource</span>

        <span class="c1"># use [lrseg, agency] to get loadsourceids</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;unitid&#39;</span><span class="p">]</span>
        <span class="n">tblloadsourceids1</span> <span class="o">=</span> <span class="n">TblLandRiverSegmentAgencyLoadSource</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lrsegagencyidtable</span><span class="p">,</span>
                                                                                         <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># use sectors/loadsourcegroups to get loadsourceids</span>
        <span class="n">tblloadsourceids2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadsourceids_from</span><span class="p">(</span><span class="n">sectorids</span><span class="o">=</span><span class="n">sectorids</span><span class="p">)</span>

        <span class="c1"># get the intersection of these two loadsourceid tables</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">tblloadsourceids1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tblloadsourceids2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span></div>

<div class="viewcode-block" id="TblJeeves.sourceCountyAgencyIDtable_from_sourceLrsegAgencyIDtable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.sourceCountyAgencyIDtable_from_sourceLrsegAgencyIDtable">[docs]</a>    <span class="k">def</span> <span class="nf">sourceCountyAgencyIDtable_from_sourceLrsegAgencyIDtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourceAgencyLrsegIDtable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1"># get relevant source data</span>
        <span class="n">TblLandRiverSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegment</span>

        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;countyid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLandRiverSegment</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sourceAgencyLrsegIDtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="n">tblsubset</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.loadsourceids_from_lrsegid_agencyid_sectorid"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.loadsourceids_from_lrsegid_agencyid_sectorid">[docs]</a>    <span class="k">def</span> <span class="nf">loadsourceids_from_lrsegid_agencyid_sectorid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lrsegids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">agencyids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sectorids</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the load sources present (whether zero acres or not) in the specified lrseg-agency-sectors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get relevant source data</span>
        <span class="n">TblLandRiverSegmentAgencyLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegmentAgencyLoadSource</span>

        <span class="c1"># Generate all combinations of the lrseg, agency, sectors</span>
        <span class="n">combos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">lrsegids</span><span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">],</span> <span class="n">agencyids</span><span class="p">[</span><span class="s1">&#39;agencyid&#39;</span><span class="p">]))</span>
        <span class="n">combos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">combos</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">])</span>

        <span class="c1"># use [lrseg, agency] to get loadsourceids</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;unitid&#39;</span><span class="p">]</span>
        <span class="n">tblloadsourceids1</span> <span class="o">=</span> <span class="n">TblLandRiverSegmentAgencyLoadSource</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">combos</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># use sectors/loadsourcegroups to get loadsourceids</span>
        <span class="n">tblloadsourceids2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadsourceids_from</span><span class="p">(</span><span class="n">sectorids</span><span class="o">=</span><span class="n">sectorids</span><span class="p">)</span>

        <span class="c1"># get the intersection of these two loadsourceid tables</span>
        <span class="n">tblloadsourceids</span> <span class="o">=</span> <span class="n">tblloadsourceids1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tblloadsourceids2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblloadsourceids</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;loadsourceid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.loadsources_from_lrseg_agency_sector"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.loadsources_from_lrseg_agency_sector">[docs]</a>    <span class="k">def</span> <span class="nf">loadsources_from_lrseg_agency_sector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lrsegs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">agencies</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sectors</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the load sources present (whether zero acres or not) in the specified lrseg-agency-sectors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get relevant source data</span>
        <span class="n">TblLandUsePreBmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandUsePreBmp</span>  <span class="c1"># use this to find load sources with &gt;0 acres</span>
        <span class="n">TblLandRiverSegmentAgencyLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegmentAgencyLoadSource</span>
        <span class="n">TblLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLoadSource</span>
        <span class="n">TblLoadSourceGroupLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLoadSourceGroupLoadSource</span>

        <span class="c1"># Convert names to IDs</span>
        <span class="n">lrsegids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lrsegids_from</span><span class="p">(</span><span class="n">lrsegnames</span><span class="o">=</span><span class="n">lrsegs</span><span class="p">)</span>
        <span class="n">agencyids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agencyids_from</span><span class="p">(</span><span class="n">agencycodes</span><span class="o">=</span><span class="n">agencies</span><span class="p">)</span>
        <span class="n">sectorids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sectorids_from</span><span class="p">(</span><span class="n">sectornames</span><span class="o">=</span><span class="n">sectors</span><span class="p">)</span>

        <span class="c1"># Generate all combinations of the lrseg, agency, sectors</span>
        <span class="n">combos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">lrsegids</span><span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">],</span> <span class="n">agencyids</span><span class="p">[</span><span class="s1">&#39;agencyid&#39;</span><span class="p">]))</span>
        <span class="n">combos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">combos</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">])</span>

        <span class="c1"># use [lrseg, agency] to get loadsourceids</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;unitid&#39;</span><span class="p">]</span>
        <span class="n">tblloadsourceids1</span> <span class="o">=</span> <span class="n">TblLandRiverSegmentAgencyLoadSource</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">combos</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># use sectors/loadsourcegroups to get loadsourceids</span>
        <span class="n">tblloadsourceids2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadsourceids_from</span><span class="p">(</span><span class="n">sectorids</span><span class="o">=</span><span class="n">sectorids</span><span class="p">)</span>

        <span class="c1"># get the intersection of these two loadsourceid tables</span>
        <span class="n">tblloadsourceids</span> <span class="o">=</span> <span class="n">tblloadsourceids1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tblloadsourceids2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># get the loadsource names from their ids</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsource&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblLoadSource</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tblloadsourceids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;loadsource&#39;</span><span class="p">]]</span></div>

    <span class="c1"># BMP Methods</span>
<div class="viewcode-block" id="TblJeeves.all_bmpnames"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.all_bmpnames">[docs]</a>    <span class="k">def</span> <span class="nf">all_bmpnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TblBmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmp</span>  <span class="c1"># get relevant source data]</span>
        <span class="k">return</span> <span class="n">TblBmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;bmpshortname&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="TblJeeves.single_bmpid_from_shortname"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.single_bmpid_from_shortname">[docs]</a>    <span class="k">def</span> <span class="nf">single_bmpid_from_shortname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bmpshortname</span><span class="p">):</span>
        <span class="n">TblBmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmp</span>  <span class="c1"># get relevant source data</span>
        <span class="k">return</span> <span class="n">TblBmp</span><span class="p">[</span><span class="s1">&#39;bmpid&#39;</span><span class="p">][</span><span class="n">TblBmp</span><span class="p">[</span><span class="s1">&#39;bmpshortname&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">bmpshortname</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>

<div class="viewcode-block" id="TblJeeves.bmpids_from_categoryids"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.bmpids_from_categoryids">[docs]</a>    <span class="k">def</span> <span class="nf">bmpids_from_categoryids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">categoryids</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">categoryids</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="n">categoryids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">categoryids</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bmpcategoryid&#39;</span><span class="p">])</span>

        <span class="n">TblBmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmp</span>  <span class="c1"># get relevant source data</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bmpcategoryid&#39;</span><span class="p">,</span> <span class="s1">&#39;bmpid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblBmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">categoryids</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tblsubset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;bmpid&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="TblJeeves.land_slabidtable_from_SourceLrsegAgencyIDtable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.land_slabidtable_from_SourceLrsegAgencyIDtable">[docs]</a>    <span class="k">def</span> <span class="nf">land_slabidtable_from_SourceLrsegAgencyIDtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SourceLrsegAgencyIDtable</span><span class="p">):</span>
        <span class="n">TblBmpLoadSourceFromTo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmpLoadSourceFromTo</span>

        <span class="n">TblBmpLoadSourceFromTo</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fromloadsourceid&#39;</span><span class="p">:</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bmpid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblBmpLoadSourceFromTo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">SourceLrsegAgencyIDtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># print(&#39;TblJeeves.land_slabidtable_from_SourceLrsegAgencyIDtable():&#39;)</span>
        <span class="c1"># print(tblsubset)</span>

        <span class="k">return</span> <span class="n">tblsubset</span></div>

<div class="viewcode-block" id="TblJeeves.animal_scabidtable_from_SourceCountyAgencyIDtable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.animal_scabidtable_from_SourceCountyAgencyIDtable">[docs]</a>    <span class="k">def</span> <span class="nf">animal_scabidtable_from_SourceCountyAgencyIDtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SourceCountyAgencyIDtable</span><span class="p">,</span> <span class="n">baseconditionid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">TblAnimalPopulation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAnimalPopulation</span>
        <span class="n">TblAnimalGroupAnimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAnimalGroupAnimal</span>
        <span class="n">TblBmpAnimalGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmpAnimalGroup</span>
        <span class="n">TblAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAgency</span>

        <span class="n">sca_table</span> <span class="o">=</span> <span class="n">SourceCountyAgencyIDtable</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># For Animals, only the NONFED agency matters, so remove all rows with agencies not equal to NONFED</span>
        <span class="n">nonfedid</span> <span class="o">=</span> <span class="n">TblAgency</span><span class="p">[</span><span class="s1">&#39;agencyid&#39;</span><span class="p">][</span><span class="n">TblAgency</span><span class="p">[</span><span class="s1">&#39;agencycode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NONFED&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sca_table</span> <span class="o">=</span> <span class="n">sca_table</span><span class="p">[</span><span class="n">sca_table</span><span class="p">[</span><span class="s2">&quot;agencyid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">nonfedid</span><span class="p">]</span>

        <span class="c1"># print(&#39;TblJeeves.animal_scabidtable_from_SourceCountyAgencyIDtable()0:&#39;)</span>
        <span class="c1"># print(sca_table)</span>

        <span class="c1"># Baseconditionid is needed for indexing with the AnimalPopulation table, so and a column for it to the SCAtable</span>
        <span class="n">sca_table</span><span class="p">[</span><span class="s1">&#39;baseconditionid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">baseconditionid</span><span class="o">.</span><span class="n">baseconditionid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># print(&#39;TblJeeves.animal_scabidtable_from_SourceCountyAgencyIDtable()1:&#39;)</span>
        <span class="c1"># print(sca_table)</span>

        <span class="c1"># Get which animals are present in the county, agency, loadsources</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;baseconditionid&#39;</span><span class="p">,</span> <span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalcount&#39;</span><span class="p">,</span> <span class="s1">&#39;animalunits&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblAnimalPopulation</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sca_table</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># print(&#39;TblJeeves.animal_scabidtable_from_SourceCountyAgencyIDtable()2:&#39;)</span>
        <span class="c1"># print(tblsubset)</span>

        <span class="c1"># Get the animalgroups that each animalid belongs to</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;animalgroupid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblAnimalGroupAnimal</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tblsubset</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># print(&#39;TblJeeves.animal_scabidtable_from_SourceCountyAgencyIDtable()3:&#39;)</span>
        <span class="c1"># print(tblsubset)</span>

        <span class="c1"># Get the BMPs that can be applied to each animalgroupid</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;animalgroupid&#39;</span><span class="p">,</span> <span class="s1">&#39;bmpid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblBmpAnimalGroup</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tblsubset</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># print(&#39;TblJeeves.animal_scabidtable_from_SourceCountyAgencyIDtable()4:&#39;)</span>
        <span class="c1"># print(tblsubset)</span>

        <span class="k">return</span> <span class="n">tblsubset</span></div>

<div class="viewcode-block" id="TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable">[docs]</a>    <span class="k">def</span> <span class="nf">manure_sftabidtable_from_SourceFromToAgencyIDtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SourceCountyAgencyIDtable</span><span class="p">,</span> <span class="n">baseconditionid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">TblAnimalPopulation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAnimalPopulation</span>
        <span class="n">TblAnimalGroupAnimal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAnimalGroupAnimal</span>
        <span class="n">TblBmpAnimalGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmpAnimalGroup</span>
        <span class="n">TblBmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmp</span>
        <span class="n">TblAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAgency</span>
        <span class="n">TblLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLoadSource</span>

        <span class="n">sca_table</span> <span class="o">=</span> <span class="n">SourceCountyAgencyIDtable</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Baseconditionid is needed for indexing with the AnimalPopulation table, so and a column for it to the SCAtable</span>
        <span class="n">sca_table</span><span class="p">[</span><span class="s1">&#39;baseconditionid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">baseconditionid</span><span class="o">.</span><span class="n">baseconditionid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># print(&#39;TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable()0:&#39;)</span>
        <span class="c1"># print(sca_table)</span>

        <span class="c1"># For Animals, only the NONFED agency matters, so remove all rows with agencies not equal to NONFED</span>
        <span class="n">nonfedid</span> <span class="o">=</span> <span class="n">TblAgency</span><span class="p">[</span><span class="s1">&#39;agencyid&#39;</span><span class="p">][</span><span class="n">TblAgency</span><span class="p">[</span><span class="s1">&#39;agencycode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NONFED&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sca_table</span> <span class="o">=</span> <span class="n">sca_table</span><span class="p">[</span><span class="n">sca_table</span><span class="p">[</span><span class="s2">&quot;agencyid&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">nonfedid</span><span class="p">]</span>

        <span class="c1"># print(&#39;TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable()1:&#39;)</span>
        <span class="c1"># print(sca_table)</span>

        <span class="c1"># For Manure, only the &quot;Non-Permitted Feeding Space&quot; and &quot;Permitted Feeding Space&quot; load sources matter,</span>
        <span class="c1"># so remove all rows with loadsources not equal to them</span>
        <span class="n">npfsid</span> <span class="o">=</span> <span class="n">TblLoadSource</span><span class="p">[</span><span class="s1">&#39;loadsourceid&#39;</span><span class="p">][</span><span class="n">TblLoadSource</span><span class="p">[</span><span class="s1">&#39;loadsource&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Non-Permitted Feeding Space&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pfsid</span> <span class="o">=</span> <span class="n">TblLoadSource</span><span class="p">[</span><span class="s1">&#39;loadsourceid&#39;</span><span class="p">][</span><span class="n">TblLoadSource</span><span class="p">[</span><span class="s1">&#39;loadsource&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Permitted Feeding Space&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">allowed_loadsource_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">npfsid</span><span class="p">]</span>  <span class="c1"># , pfsid]  (ONLY USE ONE FOR NOW) TODO: check-we only need one of the two</span>
        <span class="n">sca_table</span> <span class="o">=</span> <span class="n">sca_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sca_table</span><span class="p">[</span><span class="s1">&#39;loadsourceid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">allowed_loadsource_list</span><span class="p">)]</span>

        <span class="c1"># print(&#39;TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable()2:&#39;)</span>
        <span class="c1"># print(sca_table)</span>

        <span class="c1"># For Manure, calculate all of the From-To permutations</span>
        <span class="n">allperms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">permutations</span><span class="p">(</span><span class="n">sca_table</span><span class="o">.</span><span class="n">countyid</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">allperms</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">sfta_table</span> <span class="o">=</span> <span class="n">sca_table</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="n">sfta_table</span><span class="p">[</span><span class="s1">&#39;countyidFrom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sfta_table</span><span class="o">.</span><span class="n">countyid</span>
            <span class="n">sfta_table</span><span class="p">[</span><span class="s1">&#39;countyidTo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sfta_table</span><span class="o">.</span><span class="n">countyid</span>

            <span class="n">sfta_table</span> <span class="o">=</span> <span class="n">sfta_table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># If there aren&#39;t more than one county, then just return a blank table</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">allperms</span><span class="p">)</span>
            <span class="n">sfta_table</span> <span class="o">=</span> <span class="n">zser</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
            <span class="n">sfta_table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;countyidFrom&#39;</span><span class="p">,</span> <span class="s1">&#39;countyidTo&#39;</span><span class="p">]</span>

            <span class="c1"># print(&#39;TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable()3:&#39;)</span>
            <span class="c1"># print(sfta_table)</span>

            <span class="n">sca_table</span><span class="p">[</span><span class="s1">&#39;countyidFrom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sca_table</span><span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">]</span>  <span class="c1"># duplicate the countyid column with the countyidFrom name</span>
            <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;countyidFrom&#39;</span><span class="p">,</span> <span class="s1">&#39;countyidTo&#39;</span><span class="p">]</span>
            <span class="n">sfta_table</span> <span class="o">=</span> <span class="n">sfta_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sca_table</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

            <span class="c1"># print(&#39;TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable()4:&#39;)</span>
            <span class="c1"># print(sfta_table)</span>

        <span class="c1"># Get which animals are present in the county, agency, loadsources</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;baseconditionid&#39;</span><span class="p">,</span> <span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalcount&#39;</span><span class="p">,</span> <span class="s1">&#39;animalunits&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblAnimalPopulation</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sfta_table</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># print(&#39;TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable()5:&#39;)</span>
        <span class="c1"># print(tblsubset)</span>

        <span class="c1"># Get the animalgroups that each animalid belongs to</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;animalgroupid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalid&#39;</span><span class="p">]</span>
        <span class="n">tblsubset</span> <span class="o">=</span> <span class="n">TblAnimalGroupAnimal</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tblsubset</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="c1"># print(&#39;TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable()6:&#39;)</span>
        <span class="c1"># print(tblsubset)</span>

        <span class="c1"># # Get the BMPs that can be applied to each animalgroupid</span>
        <span class="c1"># columnmask = [&#39;animalgroupid&#39;, &#39;bmpid&#39;]</span>
        <span class="c1"># tblsubset = TblBmpAnimalGroup.loc[:, columnmask].merge(tblsubset, how=&#39;inner&#39;)</span>

        <span class="c1"># For Manure transport, there&#39;s only one bmp that should be applied (?) TODO: check that this is true</span>
        <span class="n">mtid</span> <span class="o">=</span> <span class="n">TblBmp</span><span class="p">[</span><span class="s1">&#39;bmpid&#39;</span><span class="p">][</span><span class="n">TblBmp</span><span class="p">[</span><span class="s1">&#39;bmpshortname&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ManureTransport&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">tblsubset</span><span class="p">[</span><span class="s1">&#39;bmpid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtid</span>

        <span class="n">tblsubset</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;countyid&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># print(&#39;TblJeeves.manure_sftabidtable_from_SourceFromToAgencyIDtable()7:&#39;)</span>
        <span class="c1"># print(tblsubset)</span>

        <span class="k">return</span> <span class="n">tblsubset</span></div>

    <span class="c1"># Hard Upper/Lower Bounds Methods</span>
<div class="viewcode-block" id="TblJeeves.appendBounds_to_land_slabidtable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.appendBounds_to_land_slabidtable">[docs]</a>    <span class="k">def</span> <span class="nf">appendBounds_to_land_slabidtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slabidtable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">slabidtable</span><span class="p">[</span><span class="s1">&#39;lowerbound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">slabidtable</span><span class="p">[</span><span class="s1">&#39;upperbound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="c1"># For Acres: Add all of the acres (across LoadSources) from &quot;TblLandUsePreBmp&quot;</span>
        <span class="k">return</span> <span class="n">slabidtable</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

<div class="viewcode-block" id="TblJeeves.appendBounds_to_animal_scabidtable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.appendBounds_to_animal_scabidtable">[docs]</a>    <span class="k">def</span> <span class="nf">appendBounds_to_animal_scabidtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scabidtable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">scabidtable</span><span class="p">[</span><span class="s1">&#39;lowerbound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">scabidtable</span><span class="p">[</span><span class="s1">&#39;upperbound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="c1"># For Animals: Add...?</span>
        <span class="k">return</span> <span class="n">scabidtable</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

<div class="viewcode-block" id="TblJeeves.appendBounds_to_manure_sftabidtable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.appendBounds_to_manure_sftabidtable">[docs]</a>    <span class="k">def</span> <span class="nf">appendBounds_to_manure_sftabidtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sftabidtable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">sftabidtable</span><span class="p">[</span><span class="s1">&#39;lowerbound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">sftabidtable</span><span class="p">[</span><span class="s1">&#39;upperbound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="c1"># For Dry_Tons_of_Stored_Manure: Add...?</span>
        <span class="k">return</span> <span class="n">sftabidtable</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

    <span class="c1"># Translation methods (from IDs to NAMEs)</span>
<div class="viewcode-block" id="TblJeeves.translate_slabidtable_to_slabnametable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.translate_slabidtable_to_slabnametable">[docs]</a>    <span class="k">def</span> <span class="nf">translate_slabidtable_to_slabnametable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slabidtable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">slabidtable</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Get relevant source data tables</span>
        <span class="n">TblLandRiverSegment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLandRiverSegment</span>
        <span class="n">TblState</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblState</span>
        <span class="n">TblAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAgency</span>
        <span class="n">TblLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLoadSource</span>
        <span class="n">TblBmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmp</span>

        <span class="c1"># Translate lrsegid to GeographyName</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;landriversegment&#39;</span><span class="p">,</span> <span class="s1">&#39;stateid&#39;</span><span class="p">,</span> <span class="s1">&#39;lrsegid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblLandRiverSegment</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stateabbreviation&#39;</span><span class="p">,</span> <span class="s1">&#39;stateid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblState</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to Agency codes</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;agencycode&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblAgency</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to LoadSource names</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;loadsource&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblLoadSource</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to BMP names</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bmpshortname&#39;</span><span class="p">,</span> <span class="s1">&#39;bmpid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblBmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="n">newtable</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;lrsegid&#39;</span><span class="p">,</span> <span class="s1">&#39;stateid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;bmpid&#39;</span><span class="p">,</span> <span class="s1">&#39;unitid&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">newtable</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;landriversegment&#39;</span><span class="p">:</span> <span class="s1">&#39;GeographyName&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;stateabbreviation&#39;</span><span class="p">:</span> <span class="s1">&#39;StateAbbreviation&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;agencycode&#39;</span><span class="p">:</span> <span class="s1">&#39;AgencyCode&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;loadsource&#39;</span><span class="p">:</span> <span class="s1">&#39;LoadSourceGroup&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;bmpshortname&#39;</span><span class="p">:</span> <span class="s1">&#39;BmpShortName&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;StateUniqueIdentifier&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;Amount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;Unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Percent&#39;</span>

        <span class="k">return</span> <span class="n">newtable</span></div>

<div class="viewcode-block" id="TblJeeves.translate_scabidtable_to_scabnametable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.translate_scabidtable_to_scabnametable">[docs]</a>    <span class="k">def</span> <span class="nf">translate_scabidtable_to_scabnametable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scabidtable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">scabidtable</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Get relevant source data tables</span>
        <span class="n">TblCounty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblCounty</span>
        <span class="n">TblAnimalGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAnimalGroup</span>
        <span class="n">TblAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAgency</span>
        <span class="n">TblLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLoadSource</span>
        <span class="n">TblBmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmp</span>

        <span class="c1"># Translate countyid to GeographyName (FIPS) and add stateabbreviation</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;stateabbreviation&#39;</span><span class="p">,</span> <span class="s1">&#39;fips&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblCounty</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to Agency codes</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;agencycode&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblAgency</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to LoadSource names</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;loadsource&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblLoadSource</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to BMP names</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bmpshortname&#39;</span><span class="p">,</span> <span class="s1">&#39;bmpid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblBmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to AnimalGroup names</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;animalgroupid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalgroup&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblAnimalGroup</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="n">newtable</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;bmpid&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;animalgroupid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalid&#39;</span><span class="p">,</span> <span class="s1">&#39;baseconditionid&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">newtable</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;fips&#39;</span><span class="p">:</span> <span class="s1">&#39;GeographyName&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;stateabbreviation&#39;</span><span class="p">:</span> <span class="s1">&#39;StateAbbreviation&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;agencycode&#39;</span><span class="p">:</span> <span class="s1">&#39;AgencyCode&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;loadsource&#39;</span><span class="p">:</span> <span class="s1">&#39;LoadSourceGroup&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;bmpshortname&#39;</span><span class="p">:</span> <span class="s1">&#39;BmpShortName&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;animalgroup&#39;</span><span class="p">:</span> <span class="s1">&#39;AnimalGroup&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;StateUniqueIdentifier&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;Amount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;Unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Percent&#39;</span>

        <span class="k">return</span> <span class="n">newtable</span></div>

<div class="viewcode-block" id="TblJeeves.translate_sftabidtable_to_sftabnametable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.translate_sftabidtable_to_sftabnametable">[docs]</a>    <span class="k">def</span> <span class="nf">translate_sftabidtable_to_sftabnametable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sftabidtable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">sftabidtable</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Get relevant source data tables</span>
        <span class="n">TblCounty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblCounty</span>
        <span class="n">TblAnimalGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAnimalGroup</span>
        <span class="n">TblAgency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblAgency</span>
        <span class="n">TblLoadSource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblLoadSource</span>
        <span class="n">TblBmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">TblBmp</span>

        <span class="c1"># Translate countyid to FIPSFrom and then FIPSTo (and add stateabbreviation)</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;stateabbreviation&#39;</span><span class="p">,</span> <span class="s1">&#39;fips&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblCounty</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
                                                      <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span>
                                                      <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;countyidFrom&#39;</span><span class="p">)</span>
        <span class="n">newtable</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;countyidFrom&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">newtable</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fips&#39;</span><span class="p">:</span> <span class="s1">&#39;FIPSFrom&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;fips&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblCounty</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
                                                      <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span>
                                                      <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;countyidTo&#39;</span><span class="p">)</span>
        <span class="n">newtable</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;countyid&#39;</span><span class="p">,</span> <span class="s1">&#39;countyidTo&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">newtable</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fips&#39;</span><span class="p">:</span> <span class="s1">&#39;FIPSTo&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># Translate to Agency codes</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;agencycode&#39;</span><span class="p">,</span> <span class="s1">&#39;agencyid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblAgency</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to LoadSource names</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;loadsource&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblLoadSource</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to BMP names</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bmpshortname&#39;</span><span class="p">,</span> <span class="s1">&#39;bmpid&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblBmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="c1"># Translate to AnimalGroup names</span>
        <span class="n">columnmask</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;animalgroupid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalgroup&#39;</span><span class="p">]</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">TblAnimalGroup</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">columnmask</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newtable</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>

        <span class="n">newtable</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;agencyid&#39;</span><span class="p">,</span> <span class="s1">&#39;loadsourceid&#39;</span><span class="p">,</span> <span class="s1">&#39;bmpid&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;animalgroupid&#39;</span><span class="p">,</span> <span class="s1">&#39;animalid&#39;</span><span class="p">,</span> <span class="s1">&#39;baseconditionid&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">newtable</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;stateabbreviation&#39;</span><span class="p">:</span> <span class="s1">&#39;StateAbbreviation&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;agencycode&#39;</span><span class="p">:</span> <span class="s1">&#39;AgencyCode&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;loadsource&#39;</span><span class="p">:</span> <span class="s1">&#39;LoadSourceGroup&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;bmpshortname&#39;</span><span class="p">:</span> <span class="s1">&#39;BmpShortName&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;animalgroup&#39;</span><span class="p">:</span> <span class="s1">&#39;AnimalGroup&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;StateUniqueIdentifier&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;Amount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;Unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Percent&#39;</span>

        <span class="k">return</span> <span class="n">newtable</span></div>

<div class="viewcode-block" id="TblJeeves.make_scenario_from_slabidtable"><a class="viewcode-back" href="../../../sandbox.tables.TblJeeves.html#sandbox.tables.TblJeeves.TblJeeves.make_scenario_from_slabidtable">[docs]</a>    <span class="k">def</span> <span class="nf">make_scenario_from_slabidtable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slabidtable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">newtable</span> <span class="o">=</span> <span class="n">slabidtable</span>

        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;stateuniqueidentifier&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">newtable</span><span class="p">[</span><span class="s2">&quot;unitid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">newtable</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Daniel Kaufman.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>